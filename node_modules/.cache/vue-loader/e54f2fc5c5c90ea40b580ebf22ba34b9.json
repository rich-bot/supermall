{"remainingRequest":"F:\\project\\vue\\supermall\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\project\\vue\\supermall\\src\\views\\details\\Detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\project\\vue\\supermall\\src\\views\\details\\Detail.vue","mtime":1598165639981},{"path":"F:\\project\\vue\\supermall\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596725900621},{"path":"F:\\project\\vue\\supermall\\node_modules\\babel-loader\\lib\\index.js","mtime":1596725931667},{"path":"F:\\project\\vue\\supermall\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596725900621},{"path":"F:\\project\\vue\\supermall\\node_modules\\vue-loader\\lib\\index.js","mtime":1596725926567}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Scroll from \"@/components/common/scroll/Scroll.vue\"\nimport NavBarDetail from \"@/views/details/childrendetail/NavBarDetail.vue\"\nimport BannersTwo from \"@/components/common/banners/BannersTwo.vue\"\nimport DetailBaseInfo from './childrendetail/DetailBaseInfo'\nimport DetailShopInfo from './childrendetail/DetailShopInfo'\nimport DetailGoodsInfo from './childrendetail/DetailGoodsInfo'\nimport DetailParamInfo from './childrendetail/DetailParamInfo'\nimport DetailCommentInfo from './childrendetail/DetailCommentInfo'\nimport DetailBottomBar from '@/views/details/childrendetail/DetailBottomBar'\nimport DetailRecommendInfo from './childrendetail/DetailRecommendInfo'\nimport BackToTop from '@/components/content/backToTop/BackToTop.vue'\n//网络层\nimport {getDetail, getRecommend, Goods, Shop, GoodsParam} from \"@/network/detail.js\"\nexport default {\n\tname:\"Detail\",\n\tcomponents:{\n\t\tNavBarDetail,\n\t\tBannersTwo,\n\t\tScroll,\n\t\tDetailBaseInfo,\n\t\tDetailShopInfo,\n\t\tDetailGoodsInfo,\n\t\tDetailParamInfo,\n\t\tDetailCommentInfo,\n\t\tDetailBottomBar,\n\t\tDetailRecommendInfo,\n\t\tBackToTop\n\t},\n\tdata(){\n\t\treturn {\n\t\t\t\tid:0,\n\t\t\t\titemData:null,\n\t\t\t\ttopImg:[],\n\t\t\t\tgoods: {},\n\t\t\t\tshop: {},\n\t\t\t\tdetailInfo: {},\n\t\t\t\tparamInfo: {},\n\t\t\t\tcommentInfo: {},\n\t\t\t\trecommendList: [],\n\t\t\t\tthemeTops: [],\n\t\t\t\tcurrentIndex: 0,\n\t\t\t\tisShow:false\n\t\t}\n\t},\n\tcreated() {\n\t\t/* this.id=this.$route.params.id\n\t\tgetDetail(this.id).then(res=>{\n\t\t\tthis.topImg=res.result.itemInfo.topImages;\n\t\t\tconsole.log(this.topImg);\n\t\t}) */\n\t\tthis._getDetailData()\n\t\tthis._getRecommend()\n\t},\n\tupdated() {\n\t\tthis._getThemeTops();\n\t},\n\tmethods:{\n\t\t//防抖函数\n\t\tbounce(fn,timer=300){\n\t\t\tlet timers=null;\n\t\t\treturn function(){\n\t\t\t\ttimers&&clearTimeout(timers);\n\t\t\t\ttimers=setTimeout(function(){\n\t\t\t\t\tfn.apply(this);\n\t\t\t\t\t\n\t\t\t\t},timer)\n\t\t\t}\n\t\t},\n\t\t//获得4个子组件的高度\n\t\t_getThemeTops(){\n\t\t\tthis.themeTops=[];\n\t\t\tthis.themeTops.push(this.$refs.base.$el.offsetTop);\n\t\t\tthis.themeTops.push(this.$refs.param.$el.offsetTop);\n\t\t\tthis.themeTops.push(this.$refs.comment.$el.offsetTop);\n\t\t\tthis.themeTops.push(this.$refs.recommend.$el.offsetTop);\n\t\t\tthis.themeTops.push(Number.MAX_VALUE);\n\t\t\t/* console.log(this.themeTops); */\n\t\t\t\n\t\t},\n\t\t//获取详情数据\n\t\t_getDetailData() {\n\t\t  // 1.获取iid\n\t\t  /* const iid = this.$route.query.iid\n\t\t  this.iid = iid */\n\t\t   this.id=this.$route.params.id\n\t\t  // 2.请求数据\n\t\t  getDetail(this.id).then(res => {\n\t\t    // 2.1.获取结果\n\t\t    const data = res.result;\n\t\t\n\t\t    // 2.2.获取顶部信息\n\t\t    this.topImg = data.itemInfo.topImages;\n\t\t\n\t\t    // 2.3.获取商品信息\n\t\t    this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services);\n\t\t\n\t\t    // 2.4.获取店铺信息\n\t\t    this.shop = new Shop(data.shopInfo);\n\t\t\n\t\t    // 2.5.获取商品信息\n\t\t    this.detailInfo = data.detailInfo\n\t\t\n\t\t    // 2.6.保存参数信息\n\t\t    this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule);\n\t\t\n\t\t    // 2.7.保存评论信息\n\t\t    if (data.rate.list) {\n\t\t      this.commentInfo = data.rate.list[0];\n\t\t    }\n\t\t  })\n\t\t},\n\t\t_getRecommend() {\n\t\t  getRecommend().then((res, error) => {\n\t\t    if (error) return\n\t\t    this.recommendList = res.data.list\n\t\t  })\n\t\t}\n\t    ,\n\t\t//切换标签到相应的位置\n\t\tthrowchangeIndex(index){\n\t\t\t/* console.log(index);\t */\t\n\t\t\tthis.currentIndex=index\t\t\n\t\t\tthis.$refs.scroll.scrollTo(0,-this.themeTops[index],200);\n\t\t},\n\t\tscrollBar(position){\n\t\t\t/* console.log(-position.y); */\n\t\t\tconst length=this.themeTops.length;\n\t\t\t/* console.log(length); */\n\t\t\t\n\t\t\tfor(let i=0;i<length-1;i++){\n\t\t\t\tif((this.currentIndex!=i)&&(-position.y>this.themeTops[i]&&-position.y<=this.themeTops[i+1])){\n\t\t\t\t\tconsole.log(i);\n\t\t\t\t\tthis.currentIndex=i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(-position.y>1000){\n\t\t\t\tthis.isShow=true;\n\t\t\t}else{\n\t\t\t\tthis.isShow=false;\n\t\t\t}\n\t\t},\n\t\tbackTop(){\n\t\t\tthis.$refs.scroll.scrollTo(0,0,300);\n\t\t}\n\t}\n\t,\n\tmounted() {\n\t\tconst refresh=this.bounce(this.$refs.scroll.refresh);\n\t\tthis.$bus.$on(\"loadDetail\",()=>{\n\t\t\t/* this.$refs.scroll.refresh(); */\n\t\t\trefresh();\n\t\t\t/* console.log(\"loadDetail\"); */\n\t\t})\n\t}\n      \n}\n",{"version":3,"sources":["Detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAsBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"Detail.vue","sourceRoot":"src/views/details","sourcesContent":["<template>\r\n\t<div id=\"detail\">\r\n\t\t<NavBarDetail class=\"navbar\" @throwchangeIndex=\"throwchangeIndex\" :currentIndex=\"currentIndex\" >\t\r\n\t\t</NavBarDetail>\r\n\t\t<scroll class=\"content\" :isScroll=\"3\" ref=\"scroll\" @scroll=\"scrollBar\">\r\n\t\t\t<BannersTwo :banners=\"topImg\" ref=\"base\"  >\r\n\t\t\t</BannersTwo>\r\n\t\t\t<detail-base-info :goods=\"goods\"></detail-base-info>\r\n\t\t\t<detail-shop-info :shop=\"shop\"></detail-shop-info>\r\n\t\t\t<detail-goods-info :detail-info=\"detailInfo\"></detail-goods-info>\r\n\t\t\t<detail-param-info ref=\"param\" :param-info=\"paramInfo\"></detail-param-info>\r\n\t\t\t<detail-comment-info ref=\"comment\" :comment-info=\"commentInfo\"></detail-comment-info>\r\n\t\t\t<detail-recommend-info ref=\"recommend\" :recommend-list=\"recommendList\"></detail-recommend-info>\r\n\t\t</scroll>\r\n\t\t<backToTop @click.native=\"backTop\" v-show=\"isShow\"></backToTop>\r\n\t\t<detail-bottom-bar></detail-bottom-bar>\r\n\t\t\r\n\t</div>\r\n\t\n</template>\n\n<script>\r\n\timport Scroll from \"@/components/common/scroll/Scroll.vue\"\r\n\timport NavBarDetail from \"@/views/details/childrendetail/NavBarDetail.vue\"\r\n\timport BannersTwo from \"@/components/common/banners/BannersTwo.vue\"\r\n\timport DetailBaseInfo from './childrendetail/DetailBaseInfo'\r\n\timport DetailShopInfo from './childrendetail/DetailShopInfo'\r\n\timport DetailGoodsInfo from './childrendetail/DetailGoodsInfo'\r\n\timport DetailParamInfo from './childrendetail/DetailParamInfo'\r\n\timport DetailCommentInfo from './childrendetail/DetailCommentInfo'\r\n\timport DetailBottomBar from '@/views/details/childrendetail/DetailBottomBar'\r\n\timport DetailRecommendInfo from './childrendetail/DetailRecommendInfo'\r\n\timport BackToTop from '@/components/content/backToTop/BackToTop.vue'\r\n\t//网络层\r\n\timport {getDetail, getRecommend, Goods, Shop, GoodsParam} from \"@/network/detail.js\"\r\n\texport default {\r\n\t\tname:\"Detail\",\r\n\t\tcomponents:{\r\n\t\t\tNavBarDetail,\r\n\t\t\tBannersTwo,\r\n\t\t\tScroll,\r\n\t\t\tDetailBaseInfo,\r\n\t\t\tDetailShopInfo,\r\n\t\t\tDetailGoodsInfo,\r\n\t\t\tDetailParamInfo,\r\n\t\t\tDetailCommentInfo,\r\n\t\t\tDetailBottomBar,\r\n\t\t\tDetailRecommendInfo,\r\n\t\t\tBackToTop\r\n\t\t},\r\n\t\tdata(){\r\n\t\t\treturn {\r\n\t\t\t\t\tid:0,\r\n\t\t\t\t\titemData:null,\r\n\t\t\t\t\ttopImg:[],\r\n\t\t\t\t\tgoods: {},\r\n\t\t\t\t\tshop: {},\r\n\t\t\t\t\tdetailInfo: {},\r\n\t\t\t\t\tparamInfo: {},\r\n\t\t\t\t\tcommentInfo: {},\r\n\t\t\t\t\trecommendList: [],\r\n\t\t\t\t\tthemeTops: [],\r\n\t\t\t\t\tcurrentIndex: 0,\r\n\t\t\t\t\tisShow:false\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\t/* this.id=this.$route.params.id\r\n\t\t\tgetDetail(this.id).then(res=>{\r\n\t\t\t\tthis.topImg=res.result.itemInfo.topImages;\r\n\t\t\t\tconsole.log(this.topImg);\r\n\t\t\t}) */\r\n\t\t\tthis._getDetailData()\r\n\t\t\tthis._getRecommend()\r\n\t\t},\r\n\t\tupdated() {\r\n\t\t\tthis._getThemeTops();\r\n\t\t},\r\n\t\tmethods:{\r\n\t\t\t//防抖函数\r\n\t\t\tbounce(fn,timer=300){\r\n\t\t\t\tlet timers=null;\r\n\t\t\t\treturn function(){\r\n\t\t\t\t\ttimers&&clearTimeout(timers);\r\n\t\t\t\t\ttimers=setTimeout(function(){\r\n\t\t\t\t\t\tfn.apply(this);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t},timer)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//获得4个子组件的高度\r\n\t\t\t_getThemeTops(){\r\n\t\t\t\tthis.themeTops=[];\r\n\t\t\t\tthis.themeTops.push(this.$refs.base.$el.offsetTop);\r\n\t\t\t\tthis.themeTops.push(this.$refs.param.$el.offsetTop);\r\n\t\t\t\tthis.themeTops.push(this.$refs.comment.$el.offsetTop);\r\n\t\t\t\tthis.themeTops.push(this.$refs.recommend.$el.offsetTop);\r\n\t\t\t\tthis.themeTops.push(Number.MAX_VALUE);\r\n\t\t\t\t/* console.log(this.themeTops); */\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\t//获取详情数据\r\n\t\t\t_getDetailData() {\r\n\t\t\t  // 1.获取iid\r\n\t\t\t  /* const iid = this.$route.query.iid\r\n\t\t\t  this.iid = iid */\r\n\t\t\t   this.id=this.$route.params.id\r\n\t\t\t  // 2.请求数据\r\n\t\t\t  getDetail(this.id).then(res => {\r\n\t\t\t    // 2.1.获取结果\r\n\t\t\t    const data = res.result;\r\n\t\t\t\r\n\t\t\t    // 2.2.获取顶部信息\r\n\t\t\t    this.topImg = data.itemInfo.topImages;\r\n\t\t\t\r\n\t\t\t    // 2.3.获取商品信息\r\n\t\t\t    this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services);\r\n\t\t\t\r\n\t\t\t    // 2.4.获取店铺信息\r\n\t\t\t    this.shop = new Shop(data.shopInfo);\r\n\t\t\t\r\n\t\t\t    // 2.5.获取商品信息\r\n\t\t\t    this.detailInfo = data.detailInfo\r\n\t\t\t\r\n\t\t\t    // 2.6.保存参数信息\r\n\t\t\t    this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule);\r\n\t\t\t\r\n\t\t\t    // 2.7.保存评论信息\r\n\t\t\t    if (data.rate.list) {\r\n\t\t\t      this.commentInfo = data.rate.list[0];\r\n\t\t\t    }\r\n\t\t\t  })\r\n\t\t\t},\r\n\t\t\t_getRecommend() {\r\n\t\t\t  getRecommend().then((res, error) => {\r\n\t\t\t    if (error) return\r\n\t\t\t    this.recommendList = res.data.list\r\n\t\t\t  })\r\n\t\t\t}\r\n\t\t    ,\r\n\t\t\t//切换标签到相应的位置\r\n\t\t\tthrowchangeIndex(index){\r\n\t\t\t\t/* console.log(index);\t */\t\r\n\t\t\t\tthis.currentIndex=index\t\t\r\n\t\t\t\tthis.$refs.scroll.scrollTo(0,-this.themeTops[index],200);\r\n\t\t\t},\r\n\t\t\tscrollBar(position){\r\n\t\t\t\t/* console.log(-position.y); */\r\n\t\t\t\tconst length=this.themeTops.length;\r\n\t\t\t\t/* console.log(length); */\r\n\t\t\t\t\r\n\t\t\t\tfor(let i=0;i<length-1;i++){\r\n\t\t\t\t\tif((this.currentIndex!=i)&&(-position.y>this.themeTops[i]&&-position.y<=this.themeTops[i+1])){\r\n\t\t\t\t\t\tconsole.log(i);\r\n\t\t\t\t\t\tthis.currentIndex=i;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(-position.y>1000){\r\n\t\t\t\t\tthis.isShow=true;\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.isShow=false;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbackTop(){\r\n\t\t\t\tthis.$refs.scroll.scrollTo(0,0,300);\r\n\t\t\t}\r\n\t\t}\r\n\t\t,\r\n\t\tmounted() {\r\n\t\t\tconst refresh=this.bounce(this.$refs.scroll.refresh);\r\n\t\t\tthis.$bus.$on(\"loadDetail\",()=>{\r\n\t\t\t\t/* this.$refs.scroll.refresh(); */\r\n\t\t\t\trefresh();\r\n\t\t\t\t/* console.log(\"loadDetail\"); */\r\n\t\t\t})\r\n\t\t}\r\n       \r\n\t}\n</script>\n\n<style scoped>\r\n\t#detail {\r\n\t  height: 100vh;\r\n\t  position: relative;\r\n\t  z-index: 1;\r\n\t  background-color: #fff;\r\n\t}\r\n\t.content {\r\n\t  position: absolute;\r\n\t  top: 44px;\r\n\t  bottom: 60px;\r\n\t  left: 0;\r\n\t  right: 0;\r\n\t}\r\n\t.navbar{\r\n\t\tposition: relative;\r\n\t\tbackground-color: #FFFFFF;\r\n\t\tz-index: 9;\r\n\t}\n</style>\n"]}]}